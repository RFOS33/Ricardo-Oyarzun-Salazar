---
title: "Proyecto de fin de Diplomado"
author: "Ricardo Oyarzun Salazar"
date: "22/7/2021"
output:
  pdf_document: default
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
library(psych)
library(car)
library(lmtest)
library(WRS2)
library(multcomp)
library(nlme)
library(lme4)
library(readr)
library(permuco)
library(DescTools)
library(ggplot2)
library(ggannotate)
```


__Resumen del problema a resolver (4 puntos).__
La inteligencia artificial (IA) cada vez esta abarcando más areas que ayudan al bienestar de las personas. En este contexto, las industrias acuícolas están comenzando a utilizar esta tecnología pero aún su uso es muy incipiente y no se sabe con certeza si la IA puede de manera efectiva mejorar los parámetros productivos de peces en cultivo y ser una tecnología viable en el futuro. Debido a esta problemática se ha decidido realizar un experimento utilizando IA en el fotoperiodo de la especie Salmón del Atlantico Salmo salar mantenidos en agua dulce y agua de mar con el objetivo de evaluar si la IA mejora o modifica algunos parámetros productivos de la acuicultura de Salmo salar y si existen diferencias con respecto a su fisiología en comparación al sistema tradicionl de cultivo (luces sin inteligencia artificial).

__Resumen de los datos originales (4 puntos).__
Se tomaron datos productivos de peso, largo, factor de condición y parámetros fisiológicos de actividad enzimática de ATPAsas branquial (NKA), niveles de glucosa, calcio, cloro, albúmina y cortisol. Todas las variables mencionadas corresponden a variables respuestas, mientras que las variables predictoras o factores fueron condición (con IA y sin IA) y el factor tiempo que tiene alrededor de 18 niveles (18 fechas de muestreo) para las variables respuesta peso, largo y factor de condición, mientras que las demás variables respuestas (NKA, glucosa, calcio, cloro, albúmina, cortisol) tienen 15 niveles (15 fechas de muestreo). Todas las variables respuestas son variables cuantitativas continuas. De la fecha inicial (24-09-2020) hasta la fecha 12-02-2021 los peces fueron mantenidos en agua dulce, mientras que desde las fechas 26-02-2021 hasta el 25-05-2021 los peces fueron mantenidos en agua de mar. Una flecha en las gáficas indica cuando los peces fueron trasladados al agua de mar.   

_Resumen de los métodos estadísticos utilizados (4 puntos)._
Para evaluar si la IA genera un efecto en la fisiología de los peces se realizo un ANOVA de dos vías con interacción, donde las variables condición y fecha serán las variables predictoras y para el análisis se ocupo el paquete estadístico WRS2, el cual realiza analisis estadísticos robustos cuando no se pueden cumplir los supuestos de homocedasticidad y normalidad de los datos.   



Importación de datos

```{r}
a <- read_excel("Datos_Luxmeter_Diplomado.xlsx")
a$Fechas <- as.factor(a$Fechas)
a$Condición <- as.factor(a$Condición)
a$NKA <- as.numeric(a$NKA)
a$Glucosa <- as.numeric(a$Glucosa)
a$Calcio <- as.numeric(a$Calcio)
a$Cloro <- as.numeric(a$Cloro)
a$Albumina <- as.numeric(a$Albumina)
a$Cortisol <- as.numeric(a$Cortisol)
str(a)
summary(a)
```


Eliminación de datos faltantes (NAs)

```{r}
a <- na.omit(a)
summary(a)
```

Análisis exploratorio de datos

Peso

```{r}
ab <- ggplot(a, aes(x = Fechas, y = Peso, color = Condición)) + geom_boxplot() + labs( x = "Fechas de muestreo", y = "Peso (gr)") + theme(axis.text.x = element_text(angle = 20), legend.position = c(0.1,0.8)) + stat_summary(fun.y = mean, shape = 22, position = position_dodge(width = 0.75))
ab

ggplot(a, aes(x = Fechas, y = Peso, color = Condición)) + geom_point(position = position_jitterdodge(jitter.width = 0.3, dodge.width = 0.3)) + labs( x = "Fechas de muestreo", y = "Peso (gr)") + theme(axis.text.x = element_text(angle = 20), legend.position = c(0.1,0.8))
```



```{r}
ggannotate(ab)
```



Largo

```{r}
ggplot(a, aes(x = Fechas, y = Largo, color = Condición)) + geom_boxplot() + labs( x = "Fechas de muestreo", y = "Largo (cm)") + theme(axis.text.x = element_text(angle = 20), legend.position = c(0.1,0.8)) + stat_summary(fun.y = mean, shape = 22, position = position_dodge(width = 0.75))

ggplot(a, aes(x = Fechas, y = Largo, color = Condición)) + geom_point(position = position_jitterdodge(jitter.width = 0.3, dodge.width = 0.3)) + labs( x = "Fechas de muestreo", y = "Largo (cm)") + theme(axis.text.x = element_text(angle = 20), legend.position = c(0.1,0.8))
```


Factor de condición (K)

```{r}
ggplot(a, aes(x = Fechas, y = K, color = Condición)) + geom_boxplot() + labs( x = "Fechas de muestreo", y = "Factor de condición (K)") + theme(axis.text.x = element_text(angle = 20), legend.position = c(0.2,0.2)) + stat_summary(fun.y = mean, shape = 22, position = position_dodge(width = 0.75))

ggplot(a, aes(x = Fechas, y = K, color = Condición)) + geom_point(position = position_jitterdodge(jitter.width = 0.3, dodge.width = 0.3)) + labs( x = "Fechas de muestreo", y = "Factor de condición (K)") + theme(axis.text.x = element_text(angle = 20), legend.position = c(0.2,0.2))
```


NKA

```{r}
ggplot(a, aes(x = Fechas, y = NKA, color = Condición)) + geom_boxplot() + labs( x = "Fechas de muestreo", y = "Actividad enzimática NKA (umoles ADP/mg proteina/hora)") + theme(axis.text.x = element_text(angle = 20), legend.position = c(0.1,0.8)) + stat_summary(fun.y = mean, shape = 22, position = position_dodge(width = 0.75))

ggplot(a, aes(x = Fechas, y = NKA, color = Condición)) + geom_point(position = position_jitterdodge(jitter.width = 0.3, dodge.width = 0.3)) + labs( x = "Fechas de muestreo", y = "Actividad enzimática NKA (umoles ADP/mg proteina/hora)") + theme(axis.text.x = element_text(angle = 20), legend.position = c(0.1,0.8))
```


Glucosa

```{r}
ggplot(a, aes(x = Fechas, y = Glucosa, color = Condición)) + geom_boxplot() + labs( x = "Fechas de muestreo", y = " Glucosa (mmol/L)") + theme(axis.text.x = element_text(angle = 20), legend.position = c(0.8,0.8)) + stat_summary(fun.y = mean, shape = 22, position = position_dodge(width = 0.75))

ggplot(a, aes(x = Fechas, y = Glucosa, color = Condición)) + geom_point(position = position_jitterdodge(jitter.width = 0.3, dodge.width = 0.3)) + labs( x = "Fechas de muestreo", y = "Glucosa (mmol/L)") + theme(axis.text.x = element_text(angle = 20), legend.position = c(0.8,0.8))
```



Calcio

```{r}
ggplot(a, aes(x = Fechas, y = Calcio, color = Condición)) + geom_boxplot() + labs( x = "Fechas de muestreo", y = "Calcio (mmol/L)") + theme(axis.text.x = element_text(angle = 20), legend.position = c(0.1,0.8)) + stat_summary(fun.y = mean, shape = 22, position = position_dodge(width = 0.75))

ggplot(a, aes(x = Fechas, y = Calcio, color = Condición)) + geom_point(position = position_jitterdodge(jitter.width = 0.3, dodge.width = 0.3)) + labs( x = "Fechas de muestreo", y = "Calcio (mmol/L)") + theme(axis.text.x = element_text(angle = 20), legend.position = c(0.1,0.8))
```




Cloro

```{r}
ggplot(a, aes(x = Fechas, y = Cloro, color = Condición)) + geom_boxplot() + labs( x = "Fechas de muestreo", y = "Cloro (mmol/L)") + theme(axis.text.x = element_text(angle = 20), legend.position = c(0.1,0.8)) + stat_summary(fun.y = mean, shape = 22, position = position_dodge(width = 0.75))

ggplot(a, aes(x = Fechas, y = Cloro, color = Condición)) + geom_point(position = position_jitterdodge(jitter.width = 0.3, dodge.width = 0.3)) + labs( x = "Fechas de muestreo", y = "Cloro (mmol/L)") + theme(axis.text.x = element_text(angle = 20), legend.position = c(0.1,0.8))
```


Albúmina

```{r}
ggplot(a, aes(x = Fechas, y = Albumina, color = Condición)) + geom_boxplot() + labs( x = "Fechas de muestreo", y = "Albumina (mmol/L)") + theme(axis.text.x = element_text(angle = 20), legend.position = c(0.1,0.8)) + stat_summary(fun.y = mean, shape = 22, position = position_dodge(width = 0.75))

ggplot(a, aes(x = Fechas, y = Albumina, color = Condición)) + geom_point(position = position_jitterdodge(jitter.width = 0.3, dodge.width = 0.3)) + labs( x = "Fechas de muestreo", y = "Albumina (mmol/L)") + theme(axis.text.x = element_text(angle = 20), legend.position = c(0.1,0.8))
```



Cortisol

```{r}
ggplot(a, aes(x = Fechas, y = Cortisol, color = Condición)) + geom_boxplot() + labs( x = "Fechas de muestreo", y = "Cortisol (ng/mL)") + theme(axis.text.x = element_text(angle = 20), legend.position = c(0.1,0.8)) + stat_summary(fun.y = mean, shape = 22, position = position_dodge(width = 0.75))

ggplot(a, aes(x = Fechas, y = Cortisol, color = Condición)) + geom_point(position = position_jitterdodge(jitter.width = 0.3, dodge.width = 0.3)) + labs( x = "Fechas de muestreo", y = "Cortisol (ng/mL)") + theme(axis.text.x = element_text(angle = 20), legend.position = c(0.1,0.8))
```





